{
  "metadata": {},
  "connectors": {
    "data_source": {
          "connection": "zeromq",
          "classname": "ZeroMQSubSource",
          "params": {
            "topic": "",
            "endpoint": `$LOGS_STREAM_ZMQ_ENDPOINT|tcp://0.0.0.0:5559`
          },
              "serializer": "JSONStringSerializer"
    },

  },
  "modules": {
    "log_parsing": {
      "classname": "LogParserModule",
      "args": {},
      "next_module": "log_ad"
    },
    "log_ad": {
      "classname": "AnomalyDetectionModule",
      "args": {},
      "next_module": "filter_normal"
    },
    "filter_normal": {
      "classname": "FilterModule",
      "args": {
        "key":"metadata.prediction",
        "condition": "equals",
        "value": 1
      },
      "next_module": "risk_score"
    },
    "risk_score": {
      "classname": "RiskScoreModule",
      "args": {},
      "next_module": "log_store"
    },
    "log_store": {
      "classname": "LogStoreModule",

      "args": {
        "connector": {
          "connection": "elasticsearch",
          "classname": "ElasticsearchSink",
          "params": {}
        },
      },
      "next_module": ""
    }

  }
}