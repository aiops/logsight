import pytest
from pandas import Timestamp

processed_logs = [
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 60,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742210_1386 replica FinalizedReplica, blk_1073742210_1386, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.658734333Z', 'id': None,
     'timestamp': '2021-12-17T06:02:59.909000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 60,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742209_1385 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742209',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.658867625Z', 'id': None,
        'timestamp': '2021-12-17T06:03:04.384000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 0,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742199_1375 replica FinalizedReplica, blk_1073742199_1375, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.658890125Z', 'id': None,
     'timestamp': '2021-12-17T06:03:05.130000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 0,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742200_1376 replica FinalizedReplica, blk_1073742200_1376, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.658899042Z', 'id': None,
     'timestamp': '2021-12-17T06:03:09.605000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 60,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742210_1386 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742210',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.658918917Z', 'id': None,
        'timestamp': '2021-12-17T06:03:14.079000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 60,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742201_1377 replica FinalizedReplica, blk_1073742201_1377, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.658966792Z', 'id': None,
     'timestamp': '2021-12-17T06:03:14.825000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 0,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742199_1375 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742199',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.658991833Z', 'id': None,
        'timestamp': '2021-12-17T06:03:19.300000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 60,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742202_1378 replica FinalizedReplica, blk_1073742202_1378, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.659012583Z', 'id': None,
     'timestamp': '2021-12-17T06:03:20.046000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 0,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742203_1379 replica FinalizedReplica, blk_1073742203_1379, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659020417Z', 'id': None,
     'timestamp': '2021-12-17T06:03:24.520000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 0,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742200_1376 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742200',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659033625Z', 'id': None,
        'timestamp': '2021-12-17T06:03:28.995000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 0,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742204_1380 replica FinalizedReplica, blk_1073742204_1380, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659045583Z', 'id': None,
     'timestamp': '2021-12-17T06:03:29.741000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 60,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742205_1381 replica FinalizedReplica, blk_1073742205_1381, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.659053250Z', 'id': None,
     'timestamp': '2021-12-17T06:03:34.216000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 0,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742201_1377 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742201',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659059958Z', 'id': None,
        'timestamp': '2021-12-17T06:03:38.691000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 0,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742206_1382 replica FinalizedReplica, blk_1073742206_1382, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659072333Z', 'id': None,
     'timestamp': '2021-12-17T06:03:39.436000'},
    {'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
     'level': 'INFO', 'risk_score': 60,
     'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742207_1383 replica FinalizedReplica, blk_1073742207_1383, FINALIZED',
     'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
     'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.659087542Z', 'id': None,
     'timestamp': '2021-12-17T06:03:43.911000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 0,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742202_1378 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742202',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659100583Z', 'id': None,
        'timestamp': '2021-12-17T06:03:48.386000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 0,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742203_1379 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742203',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659116083Z', 'id': None,
        'timestamp': '2021-12-17T06:03:49.132000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 60,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742204_1380 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742204',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.659136667Z', 'id': None,
        'timestamp': '2021-12-17T06:03:49.878000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 0,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742205_1381 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742205',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 0, 'ingest_timestamp': '2022-06-10T10:58:30.659153750Z', 'id': None,
        'timestamp': '2021-12-17T06:03:50.623000'}, {
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 60,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742206_1382 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742206',
        'tag_keys': ['version', 'service'], 'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'}, 'added_state': 1,
        'prediction': 1, 'ingest_timestamp': '2022-06-10T10:58:30.659210083Z', 'id': None,
        'timestamp': '2021-12-17T06:03:51.369000'}]

agg_results = [{'log_levels': {'INFO': 1}, 'prediction': 1, 'count': 1, 'timestamp': '2021-12-17T06:02:00'},
               {'log_levels': {'INFO': 19}, 'prediction': 8, 'count': 19, 'timestamp': '2021-12-17T06:03:00'}]

expected_incident_result = [
    {'timestamp': Timestamp('2021-12-17 06:04:00', freq='T'), 'risk': 100, 'status': 1, 'severity': 3,
     'tags': {'service': 'hdfs_node', 'version': 'v1.1.0'},
     'timestamp_start': Timestamp('2021-12-17 06:03:00', freq='T'),
     'timestamp_end': Timestamp('2021-12-17 06:04:00', freq='T'), 'data': [[{'timestamp': Timestamp(
        '2021-12-17 06:03:04.384000'),
        'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
        'level': 'INFO', 'risk_score': 60,
        'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742209_1385 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742209',
        'tag_keys': ['version', 'service'],
        'tags': {'service': 'hdfs_node',
                 'version': 'v1.1.0'},
        'added_state': 1, 'prediction': 1,
        'ingest_timestamp': '2022-06-10T10:58:30.658867625Z',
        'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:05.130000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742199_1375 replica FinalizedReplica, blk_1073742199_1375, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.658890125Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:09.605000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742200_1376 replica FinalizedReplica, blk_1073742200_1376, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.658899042Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:14.079000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742210_1386 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742210',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.658918917Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:14.825000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742201_1377 replica FinalizedReplica, blk_1073742201_1377, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.658966792Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:19.300000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742199_1375 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742199',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.658991833Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:20.046000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742202_1378 replica FinalizedReplica, blk_1073742202_1378, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.659012583Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:24.520000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742203_1379 replica FinalizedReplica, blk_1073742203_1379, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659020417Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:28.995000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742200_1376 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742200',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659033625Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:29.741000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742204_1380 replica FinalizedReplica, blk_1073742204_1380, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659045583Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:34.216000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742205_1381 replica FinalizedReplica, blk_1073742205_1381, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.659053250Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:38.691000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742201_1377 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742201',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659059958Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:39.436000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742206_1382 replica FinalizedReplica, blk_1073742206_1382, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659072333Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:43.911000'),
            'template': '<:URI:> Scheduling blk_<:NUM:>_<:NUM:> replica FinalizedReplica, blk_<:NUM:>_<:NUM:>, FINALIZED',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Scheduling blk_1073742207_1383 replica FinalizedReplica, blk_1073742207_1383, FINALIZED',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.659087542Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:48.386000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742202_1378 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742202',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659100583Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:49.132000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742203_1379 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742203',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659116083Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:49.878000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742204_1380 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742204',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.659136667Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:50.623000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 0,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742205_1381 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742205',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 0,
            'ingest_timestamp': '2022-06-10T10:58:30.659153750Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}],
        [{'timestamp': Timestamp(
            '2021-12-17 06:03:51.369000'),
            'template': '<:URI:> Deleted BP-<:NUM:>-<:IP:><:NUM:> blk_<:NUM:>_<:NUM:> URI file:/tmp/hadoop-hduser/dfs/data/current/BP-<:NUM:>-<:IP:><:NUM:>/current/finalized/subdir0/subdir1/blk_<:NUM:>',
            'level': 'INFO', 'risk_score': 60,
            'message': 'org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsDatasetAsyncDiskService: Deleted BP-1079210255-172.17.0.2-1639580298019 blk_1073742206_1382 URI file:/tmp/hadoop-hduser/dfs/data/current/BP-1079210255-172.17.0.2-1639580298019/current/finalized/subdir0/subdir1/blk_1073742206',
            'tag_keys': ['version', 'service'],
            'tags': {'service': 'hdfs_node',
                     'version': 'v1.1.0'},
            'added_state': 1, 'prediction': 1,
            'ingest_timestamp': '2022-06-10T10:58:30.659210083Z',
            'tag_string': "{'service': 'hdfs_node', 'version': 'v1.1.0'}"}]]}]
