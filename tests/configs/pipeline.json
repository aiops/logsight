{
  "metadata": {
    "input": "input",
    "kafka_topics": [
      "input"
    ]
  },
  "handlers": {
    "input": {
      "classname": "InputModule",
      "args": {
        "data_source": {
          "connection": "zeromq",
          "classname": "ZeroMQSubSource",
          "params": {
            "topic": "input",
            "endpoint": "tcp://0.0.0.0:5559"
          }
        }
      },
      "next_handler": "field_parsing"
    },
    "field_parsing": {
      "classname": "FieldParsingModule",
      "args": {
        "timeout_period": 30,
        "buffer_size": 500,
        "provider_threshold": 0.5
      },
      "next_handler": "log_parsing"
    },
    "log_parsing": {
      "classname": "LogParserModule",
      "args": {
        "timeout_period": 30,
        "buffer_size": 2048,
        "retrain_after": 1000
      },
      "next_handler": "anomaly_detection"
    },
    "anomaly_detection": {
      "classname": "AnomalyDetectionModule",
      "args": {
        "detector": "LogAnomalyDetector",
        "timeout_period": 20,
        "buffer_size": 2048
      },
      "next_handler": "ad_fork"
    },
    "ad_sink": {
      "classname": "DataStoreModule",
      "args": {
        "sink": {
          "connection": "elasticsearch",
          "classname": "ElasticsearchSink",
          "params": {
            "index": "log_ad"
          }
        }
      },
      "next_handler": ""
    },
    "log_aggregation": {
      "classname": "LogAggregationModule",
      "args": {
        "timeout_period": 60,
        "buffer_size": 1000
      },
      "next_handler": "agg_sink"
    },
    "ad_fork": {
      "classname": "ForkModule",
      "args": {},
      "next_handler": [
        "ad_sink",
        "log_incidents",
        "log_aggregation"
      ]
    },
    "agg_sink": {
      "classname": "DataStoreModule",
      "args": {
        "sink": {
          "connection": "elasticsearch",
          "classname": "ElasticsearchSink",
          "params": {
            "index": "log_agg"
          }
        }
      },
      "next_handler": ""
    },
    "log_incidents": {
      "classname": "LogIncidentModule",
      "args": {
        "timeout_period": 30,
        "buffer_size": 1000
      },
      "next_handler": "incidents_store"
    },
    "incidents_store": {
      "classname": "DataStoreModule",
      "args": {
        "sink": {
          "connection": "elasticsearch",
          "classname": "ElasticsearchSink",
          "params": {
            "index": "incidents"
          }
        }
      },
      "next_handler": ""
    }
  }
}